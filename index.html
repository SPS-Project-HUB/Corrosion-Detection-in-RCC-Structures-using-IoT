<!DOCTYPE html>
<html>
<head>
    <title>Corrosion Detection Live Data</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .card { border: 1px solid #ddd; padding: 15px; margin: 10px; border-radius: 5px; }
        .alert { background-color: #ffebee; border-color: #f44336; }
        .normal { background-color: #e8f5e8; border-color: #4caf50; }
    </style>
</head>
<body>
    <h1>🏗️ Corrosion Detection System - Live Data</h1>
    <div id="data-container"></div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            databaseURL: "https://corrosion-detection-in-rcc-default-rtdb.asia-southeast1.firebasedatabase.app/"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Reference to live data
        const liveDataRef = database.ref('live_data');

        liveDataRef.on('value', (snapshot) => {
            const data = snapshot.val();
            if (data) {
                updateDisplay(data);
            }
        });

        function updateDisplay(data) {
            const container = document.getElementById('data-container');
            const hasBaseline = data.has_baseline;
            
            let html = `
                <div class="card ${hasBaseline ? 'normal' : 'alert'}">
                    <h3>📊 Live Sensor Readings</h3>
                    <p><strong>Timestamp:</strong> ${data.timestamp}</p>
                    <p><strong>Flex Sensor:</strong> ${data.flex_sensor}</p>
                    <p><strong>Moisture Level:</strong> ${data.moisture_level}</p>
                    <p><strong>Temperature:</strong> ${data.temperature_c} °C</p>
                    <p><strong>Humidity:</strong> ${data.humidity_percent} %</p>
                    <p><strong>Resistance:</strong> ${data.resistance_ohms} Ω</p>
                    <p><strong>Baseline Status:</strong> ${hasBaseline ? '✅ Stored' : '⚠️ Not Set'}</p>
                </div>
            `;

            if (hasBaseline) {
                html += `
                    <div class="card normal">
                        <h3>💾 Stored Baseline Values</h3>
                        <p><strong>Flex Sensor:</strong> ${data.baseline_flex}</p>
                        <p><strong>Moisture:</strong> ${data.baseline_moisture}</p>
                        <p><strong>Temperature:</strong> ${data.baseline_temperature} °C</p>
                        <p><strong>Resistance:</strong> ${data.baseline_resistance} Ω</p>
                    </div>
                `;
            }

            container.innerHTML = html;
        }
    </script>
</body>
</html>
